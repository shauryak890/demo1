{"ast":null,"code":"import React,{useState}from'react';import axios from'axios';import{useNavigate}from'react-router-dom';import{toast}from'react-toastify';import'./Auth.css';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";function Login(_ref){let{setUser}=_ref;const[email,setEmail]=useState('');const[password,setPassword]=useState('');const[error,setError]=useState('');const navigate=useNavigate();const apiBaseUrl=process.env.REACT_APP_API_BASE_URL;const handleSubmit=async e=>{e.preventDefault();setError('');// Validate inputs\nif(!email||!password){setError('Please fill in all fields');toast.error('Please fill in all fields');return;}try{const loginData={email:email.trim(),password:password.trim()};// Debug logs\nconsole.log('Making login request to:',\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/auth/login\"));console.log('With data:',loginData);const response=await axios({method:'POST',url:\"\".concat(process.env.REACT_APP_API_BASE_URL,\"/auth/login\"),data:loginData,headers:{'Content-Type':'application/json','Accept':'application/json'},validateStatus:status=>{return status<500;// Resolve only if status is less than 500\n}});console.log('Response:',response);if(response.status===200&&response.data.token){localStorage.setItem('token',response.data.token);setUser({id:response.data.id,role:response.data.role,email:response.data.email,agentId:response.data.agentId});toast.success('Login successful!');navigate('/',{state:{from:'/login'}});}else{const errorMsg=response.data.error||'Login failed';setError(errorMsg);toast.error(errorMsg);}}catch(error){var _error$response,_error$response2,_error$response3,_error$response4,_error$response4$data;console.error('Login error:',{message:error.message,response:(_error$response=error.response)===null||_error$response===void 0?void 0:_error$response.data,status:(_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status,data:(_error$response3=error.response)===null||_error$response3===void 0?void 0:_error$response3.data});const errorMessage=((_error$response4=error.response)===null||_error$response4===void 0?void 0:(_error$response4$data=_error$response4.data)===null||_error$response4$data===void 0?void 0:_error$response4$data.error)||'Login failed. Please try again.';setError(errorMessage);toast.error(errorMessage);}};return/*#__PURE__*/_jsx(\"div\",{className:\"auth-container\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"auth-wrapper\",children:[/*#__PURE__*/_jsx(\"h2\",{className:\"auth-title\",children:\"Login\"}),error&&/*#__PURE__*/_jsx(\"div\",{className:\"error-message\",children:error}),/*#__PURE__*/_jsxs(\"form\",{className:\"auth-form\",onSubmit:handleSubmit,children:[/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"input-label\",htmlFor:\"email\",children:\"Email\"}),/*#__PURE__*/_jsx(\"input\",{type:\"email\",id:\"email\",className:\"input-field\",placeholder:\"Enter your email\",value:email,onChange:e=>setEmail(e.target.value),required:true})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"input-group\",children:[/*#__PURE__*/_jsx(\"label\",{className:\"input-label\",htmlFor:\"password\",children:\"Password\"}),/*#__PURE__*/_jsx(\"input\",{type:\"password\",id:\"password\",className:\"input-field\",placeholder:\"Enter your password\",value:password,onChange:e=>setPassword(e.target.value),required:true})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",className:\"submit-button\",children:\"Login\"})]}),/*#__PURE__*/_jsxs(\"p\",{className:\"auth-link\",children:[\"Don't have an account?\",/*#__PURE__*/_jsx(\"a\",{href:\"/register\",children:\"Register\"})]})]})});}export default Login;","map":{"version":3,"names":["React","useState","axios","useNavigate","toast","jsx","_jsx","jsxs","_jsxs","Login","_ref","setUser","email","setEmail","password","setPassword","error","setError","navigate","apiBaseUrl","process","env","REACT_APP_API_BASE_URL","handleSubmit","e","preventDefault","loginData","trim","console","log","concat","response","method","url","data","headers","validateStatus","status","token","localStorage","setItem","id","role","agentId","success","state","from","errorMsg","_error$response","_error$response2","_error$response3","_error$response4","_error$response4$data","message","errorMessage","className","children","onSubmit","htmlFor","type","placeholder","value","onChange","target","required","href"],"sources":["C:/Users/shaur/OneDrive/Desktop/demo1/frontend/src/components/Login.js"],"sourcesContent":["import React, { useState } from 'react';\r\nimport axios from 'axios';\r\nimport { useNavigate } from 'react-router-dom';\r\nimport { toast } from 'react-toastify';\r\nimport './Auth.css';\r\n\r\nfunction Login({ setUser }) {\r\n  const [email, setEmail] = useState('');\r\n  const [password, setPassword] = useState('');\r\n  const [error, setError] = useState('');\r\n  const navigate = useNavigate();\r\n\r\n  const apiBaseUrl = process.env.REACT_APP_API_BASE_URL;\r\n\r\n  const handleSubmit = async (e) => {\r\n    e.preventDefault();\r\n    setError('');\r\n\r\n    // Validate inputs\r\n    if (!email || !password) {\r\n      setError('Please fill in all fields');\r\n      toast.error('Please fill in all fields');\r\n      return;\r\n    }\r\n\r\n    try {\r\n      const loginData = {\r\n        email: email.trim(),\r\n        password: password.trim()\r\n      };\r\n\r\n      // Debug logs\r\n      console.log('Making login request to:', `${process.env.REACT_APP_API_BASE_URL}/auth/login`);\r\n      console.log('With data:', loginData);\r\n\r\n      const response = await axios({\r\n        method: 'POST',\r\n        url: `${process.env.REACT_APP_API_BASE_URL}/auth/login`,\r\n        data: loginData,\r\n        headers: {\r\n          'Content-Type': 'application/json',\r\n          'Accept': 'application/json'\r\n        },\r\n        validateStatus: (status) => {\r\n          return status < 500; // Resolve only if status is less than 500\r\n        }\r\n      });\r\n\r\n      console.log('Response:', response);\r\n\r\n      if (response.status === 200 && response.data.token) {\r\n        localStorage.setItem('token', response.data.token);\r\n        setUser({\r\n          id: response.data.id,\r\n          role: response.data.role,\r\n          email: response.data.email,\r\n          agentId: response.data.agentId\r\n        });\r\n        toast.success('Login successful!');\r\n        navigate('/', { state: { from: '/login' } });\r\n      } else {\r\n        const errorMsg = response.data.error || 'Login failed';\r\n        setError(errorMsg);\r\n        toast.error(errorMsg);\r\n      }\r\n    } catch (error) {\r\n      console.error('Login error:', {\r\n        message: error.message,\r\n        response: error.response?.data,\r\n        status: error.response?.status,\r\n        data: error.response?.data\r\n      });\r\n      \r\n      const errorMessage = error.response?.data?.error || 'Login failed. Please try again.';\r\n      setError(errorMessage);\r\n      toast.error(errorMessage);\r\n    }\r\n  };\r\n\r\n  return (\r\n    <div className=\"auth-container\">\r\n      <div className=\"auth-wrapper\">\r\n        <h2 className=\"auth-title\">Login</h2>\r\n        {error && <div className=\"error-message\">{error}</div>}\r\n        \r\n        <form className=\"auth-form\" onSubmit={handleSubmit}>\r\n          <div className=\"input-group\">\r\n            <label className=\"input-label\" htmlFor=\"email\">Email</label>\r\n            <input\r\n              type=\"email\"\r\n              id=\"email\"\r\n              className=\"input-field\"\r\n              placeholder=\"Enter your email\"\r\n              value={email}\r\n              onChange={(e) => setEmail(e.target.value)}\r\n              required\r\n            />\r\n          </div>\r\n\r\n          <div className=\"input-group\">\r\n            <label className=\"input-label\" htmlFor=\"password\">Password</label>\r\n            <input\r\n              type=\"password\"\r\n              id=\"password\"\r\n              className=\"input-field\"\r\n              placeholder=\"Enter your password\"\r\n              value={password}\r\n              onChange={(e) => setPassword(e.target.value)}\r\n              required\r\n            />\r\n          </div>\r\n\r\n          <button type=\"submit\" className=\"submit-button\">Login</button>\r\n        </form>\r\n\r\n        <p className=\"auth-link\">\r\n          Don't have an account?<a href=\"/register\">Register</a>\r\n        </p>\r\n      </div>\r\n    </div>\r\n  );\r\n}\r\n\r\nexport default Login;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}